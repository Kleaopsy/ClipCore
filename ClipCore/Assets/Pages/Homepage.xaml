<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="ClipCore.Assets.Pages.Homepage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:models="using:ClipCore.Assets.Functions"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:converters="using:ClipCore.Assets.Converters"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <converters:FavoriteIconConverter x:Key="FavoriteIconConverter"/>
        <converters:FavoriteColorConverter x:Key="FavoriteColorConverter"/>
    </Page.Resources>

    <Grid Padding="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <Grid Grid.Row="0" Margin="0,0,0,20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="74"/>
                <ColumnDefinition Width="32"/>
            </Grid.ColumnDefinitions>

            <!-- Title & Stats -->
            <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" Spacing="4">
                <TextBlock x:Name="homepageTitle" Text="Clipboard History" 
                          FontSize="20" 
                          FontWeight="Bold"/>
                <TextBlock x:Name="StatsText"
                          Text="5 items · 2 favorites" 
                          FontSize="13"
                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
            </StackPanel>

            <Grid Grid.Row="1" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                <RadioButton Margin="-26,0,0,0" x:Name="LayoutList" GroupName="ViewMode" 
                             ToolTipService.ToolTip="List View" 
                             Style="{StaticResource FilterRadioButtonStyle}"
                             IsChecked="True"
                             Checked="LayoutView_Changed">
                    <FontIcon Glyph="&#xE8EF;" FontSize="12"/>
                </RadioButton>
                <RadioButton Margin="0,0,0,0" x:Name="LayoutGrid" GroupName="ViewMode" 
                             ToolTipService.ToolTip="Grid View" 
                             Style="{StaticResource FilterRadioButtonStyle}"
                             Checked="LayoutView_Changed">
                    <FontIcon Glyph="&#xE80A;" FontSize="12"/>
                </RadioButton>
            </Grid>

            <Button Grid.Row="1" Grid.Column="2"
                   Style="{StaticResource FilterButtonStyle}"
                   Click="FilterButton_Click" VerticalAlignment="Bottom"
                   ToolTipService.ToolTip="Filter">
                <FontIcon Glyph="&#xE71C;" FontSize="12"/>
                <Button.Flyout>
                    <Flyout x:Name="FilterFlyout" Placement="Bottom">
                        <StackPanel Width="220" Spacing="8">
                            <TextBlock Text="Filter by Type" x:Name="FilterByTypeText" 
                                      FontWeight="SemiBold" 
                                      Margin="0,0,0,8"/>

                            <ToggleButton x:Name="FilterAll"
                                        Content="All Items"
                                        Style="{StaticResource FilterChipStyle}"
                                        IsChecked="True"
                                        HorizontalAlignment="Stretch"
                                        Click="FilterToggle_Click">
                                <ToggleButton.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xE8FD;" FontSize="14"/>
                                            <TextBlock Text="All Items"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ToggleButton.ContentTemplate>
                            </ToggleButton>

                            <ToggleButton x:Name="FilterText"
                                        Content="Text"
                                        Style="{StaticResource FilterChipStyle}"
                                        HorizontalAlignment="Stretch"
                                        Click="FilterToggle_Click">
                                <ToggleButton.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xE8A5;" FontSize="14"/>
                                            <TextBlock Text="Text"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ToggleButton.ContentTemplate>
                            </ToggleButton>

                            <ToggleButton x:Name="FilterImage"
                                        Content="Images"
                                        Style="{StaticResource FilterChipStyle}"
                                        HorizontalAlignment="Stretch"
                                        Click="FilterToggle_Click">
                                <ToggleButton.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xEB9F;" FontSize="14"/>
                                            <TextBlock Text="Images"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ToggleButton.ContentTemplate>
                            </ToggleButton>

                            <ToggleButton x:Name="FilterFiles"
                                        Content="File"
                                        Style="{StaticResource FilterChipStyle}"
                                        HorizontalAlignment="Stretch"
                                        Click="FilterToggle_Click">
                                <ToggleButton.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xE8B7;" FontSize="14"/>
                                            <TextBlock Text="Files"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ToggleButton.ContentTemplate>
                            </ToggleButton>

                            <ToggleButton x:Name="FilterCode"
                                        Content="Code"
                                        Style="{StaticResource FilterChipStyle}"
                                        HorizontalAlignment="Stretch"
                                        Click="FilterToggle_Click">
                                <ToggleButton.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xE943;" FontSize="14"/>
                                            <TextBlock Text="Codes"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ToggleButton.ContentTemplate>
                            </ToggleButton>

                            <!--
                            <MenuFlyoutSeparator/>
                        
                            <ToggleButton x:Name="FilterFavorites"
                                        Content="Favorites Only"
                                        Style="{StaticResource FilterChipStyle}"
                                        HorizontalAlignment="Stretch"
                                        Click="FilterToggle_Click">
                                <ToggleButton.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xE734;" FontSize="14"/>
                                            <TextBlock Text="Favorites Only"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ToggleButton.ContentTemplate>
                            </ToggleButton>
                            -->
                        </StackPanel>
                    </Flyout>
                </Button.Flyout>
            </Button>
        </Grid>

        <!-- Clipboard Items List -->
        <Grid Grid.Row="1">
            <ScrollViewer>
                <!-- List View -->
                <Grid>
                    <ItemsControl x:Name="ClipboardItemsControl" Visibility="Visible">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Spacing="0"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="models:ClipBoard">
                                <Border Style="{StaticResource ClipboardCardStyle}" Margin="0,0,0,12"
                                PointerPressed="ClipboardCard_PointerPressed">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Type Icon / Image Thumbnail -->
                                        <Grid Grid.Column="0" Width="44" Height="44" Margin="0,0,16,0">
                                            <!-- Default Icon (tüm tipler için) -->
                                            <Border x:Name="IconBorder"
                                            Background="{ThemeResource AccentFillColorDefaultBrush}"
                                            CornerRadius="8">
                                                <FontIcon Glyph="{x:Bind TypeIcon, Mode=OneWay}"
                                                FontSize="20"
                                                Foreground="White"/>
                                            </Border>

                                            <!-- Image Thumbnail (sadece image için) -->
                                            <Border x:Name="ImageBorder"
                                            x:Load="{x:Bind IsImageType, Mode=OneWay}"
                                            CornerRadius="8"
                                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                                                <Image x:Name="ThumbnailImage"
                                               Stretch="UniformToFill"
                                               Loaded="ThumbnailImage_Loaded"/>
                                            </Border>
                                        </Grid>

                                        <!-- Content -->
                                        <StackPanel Grid.Column="1" 
                                        VerticalAlignment="Center"
                                        Spacing="4">
                                            <TextBlock Text="{x:Bind PreviewText, Mode=OneWay}"
                                            Style="{StaticResource ClipboardTitleStyle}"
                                            TextWrapping="NoWrap"
                                            TextTrimming="CharacterEllipsis"/>
                                            <TextBlock Text="{x:Bind FormattedTimestamp, Mode=OneWay}"
                                            Style="{StaticResource ClipboardTimestampStyle}"/>
                                        </StackPanel>

                                        <!-- Actions -->
                                        <StackPanel Grid.Column="2"
                                        Orientation="Horizontal"
                                        Spacing="4"
                                        VerticalAlignment="Center">

                                            <!-- Favorite Button -->
                                            <Button Style="{StaticResource IconButtonStyle}"
                                            Click="FavoriteButton_Click"
                                            Tag="{x:Bind}" models:CursorHelper.Cursor="Hand"
                                            ToolTipService.ToolTip="Favorite">
                                                <FontIcon Glyph="{x:Bind IsFavorite, Converter={StaticResource FavoriteIconConverter}, Mode=OneWay}"
                                                  FontSize="16"
                                                  Foreground="{x:Bind IsFavorite, Converter={StaticResource FavoriteColorConverter}, Mode=OneWay}"/>
                                            </Button>

                                            <!-- Copy Button -->
                                            <Button Style="{StaticResource IconButtonStyle}"
                                            Click="CopyButton_Click"
                                            Tag="{x:Bind}" models:CursorHelper.Cursor="Hand"
                                            ToolTipService.ToolTip="Copy">
                                                <FontIcon Glyph="&#xE8C8;" FontSize="16"/>
                                            </Button>

                                            <!-- Delete Button -->
                                            <Button Style="{StaticResource IconButtonStyle}"
                                            Click="DeleteButton_Click"
                                            Tag="{x:Bind}" models:CursorHelper.Cursor="Hand"
                                            ToolTipService.ToolTip="Delete">
                                                                    <FontIcon Glyph="&#xE74D;" FontSize="16"/>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- Grid View -->
                    <ItemsControl x:Name="ClipboardGridControl" Visibility="Collapsed">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid Orientation="Horizontal" 
                                          ItemWidth="300"
                                          MaximumRowsOrColumns="5"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="models:ClipBoard">
                                <Border Style="{StaticResource ClipboardCardStyle}" 
                                Margin="0,0,12,12"
                                MinHeight="200"
                                PointerPressed="ClipboardCard_PointerPressed">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Type Icon / Image Thumbnail - Centered at top -->
                                        <Grid Grid.Row="0" 
                                        Width="120" 
                                        Height="120" 
                                        HorizontalAlignment="Center"
                                        Margin="0,0,0,12">

                                            <!-- Default Icon -->
                                            <Border x:Name="GridIconBorder"
                                            Background="{ThemeResource AccentFillColorDefaultBrush}"
                                            CornerRadius="12">
                                                <FontIcon Glyph="{x:Bind TypeIcon, Mode=OneWay}"
                                                  FontSize="48"
                                                  Foreground="White"/>
                                            </Border>

                                            <!-- Image Thumbnail -->
                                            <Border x:Name="GridImageBorder"
                                            x:Load="{x:Bind IsImageType, Mode=OneWay}"
                                            CornerRadius="12"
                                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                                                <Image x:Name="GridThumbnailImage"
                                                Stretch="UniformToFill"
                                                Loaded="ThumbnailImage_Loaded"/>
                                            </Border>
                                        </Grid>

                                        <!-- Content - Center -->
                                        <StackPanel Grid.Row="1" 
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Spacing="4">
                                            <TextBlock Text="{x:Bind PreviewText, Mode=OneWay}"
                                            Style="{StaticResource ClipboardTitleStyle}"
                                            TextWrapping="Wrap"
                                            TextTrimming="CharacterEllipsis"
                                            MaxLines="2"
                                            TextAlignment="Center"
                                            MaxWidth="200"/>
                                            <TextBlock Text="{x:Bind FormattedTimestamp, Mode=OneWay}"
                                               Style="{StaticResource ClipboardTimestampStyle}"
                                               TextAlignment="Center"/>
                                        </StackPanel>

                                        <!-- Actions - Bottom centered -->
                                        <StackPanel Grid.Row="2"
                                        Orientation="Horizontal"
                                        Spacing="4"
                                        HorizontalAlignment="Center">

                                            <!-- Favorite Button -->
                                            <Button Style="{StaticResource IconButtonStyle}"
                                            Click="FavoriteButton_Click"
                                            Tag="{x:Bind}" models:CursorHelper.Cursor="Hand"
                                            ToolTipService.ToolTip="Favorite">
                                                <FontIcon Glyph="{x:Bind IsFavorite, Converter={StaticResource FavoriteIconConverter}, Mode=OneWay}"
                                                  FontSize="16"
                                                  Foreground="{x:Bind IsFavorite, Converter={StaticResource FavoriteColorConverter}, Mode=OneWay}"/>
                                            </Button>

                                            <!-- Copy Button -->
                                            <Button Style="{StaticResource IconButtonStyle}"
                                            Click="CopyButton_Click"
                                            Tag="{x:Bind}" models:CursorHelper.Cursor="Hand"
                                            ToolTipService.ToolTip="Copy">
                                                <FontIcon Glyph="&#xE8C8;" FontSize="16"/>
                                            </Button>

                                            <!-- Delete Button -->
                                            <Button Style="{StaticResource IconButtonStyle}"
                                            Click="DeleteButton_Click"
                                            Tag="{x:Bind}" models:CursorHelper.Cursor="Hand"
                                            ToolTipService.ToolTip="Delete">
                                                <FontIcon Glyph="&#xE74D;" FontSize="16"/>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </ScrollViewer>
        </Grid>
        <Border x:Name="CopyNotificationBorder"
        Visibility="Collapsed"
        Background="{ThemeResource AccentFillColorDefaultBrush}"
        CornerRadius="8"
        Padding="16,12"
        HorizontalAlignment="Center"
        VerticalAlignment="Bottom"
        Margin="0,0,0,24"
        Grid.Row="1">
            <Border.Shadow>
                <ThemeShadow />
            </Border.Shadow>
            <StackPanel Orientation="Horizontal" Spacing="12">
                <FontIcon Glyph="&#xE73E;" 
                  FontSize="16"
                  Foreground="White"/>
                <TextBlock Text="Copied to clipboard"
                   FontSize="14"
                   FontWeight="Medium"
                   Foreground="White"/>
            </StackPanel>
        </Border>
    </Grid>
</Page>
